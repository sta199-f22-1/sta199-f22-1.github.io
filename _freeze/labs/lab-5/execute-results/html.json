{
  "hash": "65875439ddbae47a11fc0ae10a837df0",
  "result": {
    "markdown": "---\ntitle: \"Lab 5 - Predicting a numerical outcome\"\ncategories: \"Lab\"\n---\n\n\n::: callout-important\nThis lab is due Friday, November 4 at 11:59pm.\n:::\n\n# Learning Goals\n\n-   Use tidymodels framework to build a linear model and estimate regression parameters\n\n-   Visualize your linear model\n\n## Intro\n\nParasites can cause infectious disease -- but not all animals are affected by the same parasites.\nSome parasites are present in a multitude of species and others are confined to a single host.\nIt is hypothesized that closely related hosts are more likely to share the same parasites.\nMore specifically, it is thought that closely related hosts will live in similar environments and have similar genetic makeup that coincides with optimal conditions for the same parasite to flourish.\n\nIn this lab we will see how much evolutionary history predicts parasite similarity.\n\n## The Data\n\nToday's dataset comes from an Ecology Letters paper by Cooper at al. (2012) entitled \"Phylogenetic host specificity and understanding parasite sharing in primates\" located [here](https://onlinelibrary.wiley.com/doi/10.1111/j.1461-0248.2012.01858.x).\nThe goal of the paper was to identify the ability of evolutionary history and ecological traits to characterize parasite host specificity.\n\nEach row of the data contains two species, `species1` and `species2`.\n\nSubsequent columns describe metrics that compare the species:\n\n-   `divergence_time`: how many (millions) of years ago the two species diverged.\n    i.e. how many million years ago they were the same species.\n\n-   `distance`: geodesic distance between species geographic range centroids (in kilometers)\n\n-   `BMdiff`: difference in body mass between the two species (in grams)\n\n-   `precdiff`: difference in mean annual precipitation across the two species geographic ranges (mm)\n\n-   `parsim`: a measure of parasite similarity (proportion of parasites shared between species, ranges from 0 to 1.)\n\nThe data are available in `parasites.csv` in the data folder.\n\n## Packages\n\nWe'll use the **tidyverse** package for much of the data wrangling and visualization.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels)\n```\n:::\n\n\n## Exercises\n\n::: callout-important\nPick another member of the team write the answer to Exercise 1.\nAll others should contribute to the discussion but only one person should type up the answer, render the document, commit, and push to GitHub.\nAll others should **not** touch the document.\n:::\n\nTo get started, load the data and save the data frame as `parasites`.\n\n1.  Let's start by examining the relationship between `divergence_time` and `parsim`.\n    a.  Based on the goals of the analysis, what is the response variable?\n\n    b.  Visualize the relationship between the two variables.\n\n    c.  Use the visualization to describe the relationship between the two variables.\n\n::: callout-important\nAfter the team member working on Exercise 1 renders, commits, and pushes, another team member should pull their changes and render the document.\nThen, they should write the answer to Exercise 2.\nAll others should contribute to the discussion but only one person should type up the answer, render the document, commit, and push to GitHub.\nAll others should **not** touch the document.\n:::\n\n2.  Next, we'll model this relationship.\n\n    a.  Fit the model and write the estimated regression equation.\n\n    b.  Interpret the slope and the intercept in the context of the data.\n\n    c.  Recreate the visualization from Exercise 1, this time adding a regression line to the visualization.\n\n    d.  What do you notice about the prediction (regression) line that may be strange, particularly for very large divergence times?\n\n::: callout-important\nAfter the team member working on Exercise 2 renders, commits, and pushes, another team member should pull their changes and render the document.\nThen, they should write the answer to Exercise 3.\nAll others should contribute to the discussion but only one person should type up the answer, render the document, commit, and push to GitHub.\nAll others should **not** touch the document.\n:::\n\n3.  Since `parsim` takes values between 0 and 1, we want to transform this variable so that it can range between (−∞,+∞).\n    This will be better suited for fitting a regression model (and interpreting predicted values!)\n\n    a.  Using mutate, create a new variable `transformed_parsim` that is calculated as `log(parsim/(1-parsim))`.\n        Add this variable to your data frame.\n        Note: `log()` in R represents taking the **nautral log**.\n\n    b.  Then, visualize the relationship between divergence_time and `transformed_parsim`.\n        Add a regression line to your visualization.\n\n    c.  Write a 1-2 sentence description of what you observe in the visualization.\n\n::: callout-important\nAfter the team member working on Exercise 3 renders, commits, and pushes, another team member should pull their changes and render the document.\nThen, they should write the answer to Exercise 4.\nAll others should contribute to the discussion but only one person should type up the answer, render the document, commit, and push to GitHub.\nAll others should **not** touch the document.\n:::\n\n4.  *Which variable is the strongest individual predictor of parasite similarity between species?* To answer this question, begin by fitting a linear regression model to each pair of variables.\n    Do not report the model outputs in a tidy format but save each one as `dt_model`, `dist_model`, `BM_model`, and `prec_model`, respectively.\n\n    -   `divergence_time` and `transformed_parsim`\n\n    -   `distance` and `transformed_parsim`\n\n    -   `BMdiff` and `transformed_parsim`\n\n    -   `precdiff` and `transformed_parsim`\n\n    a.  Report the slops for each of these models.\n        Use proper notation.\n\n    b.  To answer the question of interest, would it be useful to compare the slopes in each model to choose the variable that is the strongest predictor of parasite similarity?\n        Why or why not?\n\n::: callout-important\nAfter the team member working on Exercise 4 renders, commits, and pushes, another team member should pull their changes and render the document.\nThen, they should write the answer to Exercise 5.\nAll others should contribute to the discussion but only one person should type up the answer, render the document, commit, and push to GitHub.\nAll others should **not** touch the document.\n:::\n\n5.  Now, what if calculated $R^2$ to help answer our question?\n    To compare the explanatory power of each individual predictor, we will look at $R^2$ between the models.\n    $R^2$ is a measure of how much of the variability in the response variable is explained by the model.\n\n    As you may have guessed from the name $R^2$ can be calculated by squaring the correlation when we have a simple linear regression model.\n    The correlation r takes values -1 to 1, therefore, $R^2$ takes values 0 to 1.\n    Intuitively, if r=1 or −1, then $R^2$=1, indicating the model is a perfect fit for the data.\n    If r≈0 then $R^2$≈0, indicating the model is a very bad fit for the data.\n\n    You can calculate $R^2$ using the glance function.\n    For example, you can calculate $R^2$ for dt_model using the code `glance(dt_model)$r.squared`.\n\n    a.  Calculate and report $R^2$ for each model fit in the previous exercise.\n\n    b.  To answer our question of interest, would it be useful to compare the $R^2$ in each model to choose the variable that is the strongest predictor of parasite similarity?\n        Why or why not?\n\n::: callout-important\nAfter the team member working on Exercise 5 renders, commits, and pushes, **all other team members** should pull the changes and render the document.\nFinally, a team member different than the one responsible for typing up responses to Exercise 5 should do the last task outlined below.\n:::\n\n# Submission\n\n::: callout-warning\nBefore you wrap up the assignment, make sure all documents are updated on your GitHub repo.\nWe will be checking these to make sure you have been practicing how to render and push changes.\n\nYou must turn in a PDF file to the Gradescope page by the submission deadline to be considered \"on time\".\n\nMake sure your data are tidy!\nThat is, your code should not be running off the pages and spaced properly.\nSee: <https://style.tidyverse.org/ggplot2.html>.\n:::\n\nTo submit your assignment:\n\n-   Go to <http://www.gradescope.com> and click *Log in* in the top right corner.\n-   Click *School Credentials* $\\rightarrow$ *Duke NetID* and log in using your NetID credentials.\n-   Click on your *STA 199* course.\n-   Click on the assignment, and you'll be prompted to submit it.\n-   Mark all the pages associated with exercise. All the pages of your lab should be associated with at least one question (i.e., should be \"checked\"). *If you do not do this, you will be subject to lose points on the assignment.*\n-   Select the first page of your .pdf submission to be associated with the *\"Workflow & formatting\"* question.\n\n# Grading\n\n| Component             | Points |\n|:----------------------|:-------|\n| Ex 1                  | 8      |\n| Ex 2                  | 14     |\n| Ex 3                  | 8      |\n| Ex 4                  | 8      |\n| Ex 4                  | 7      |\n| Workflow & formatting | 5      |\n| **Total**             | **50** |\n\n::: callout-note\nThe \"Workflow & formatting\" component assesses the reproducible workflow.\nThis includes:\n\n-   having at least 3 informative commit messages\n-   labeling the code chunks\n-   having readable code that does not exceed 80 characters, i.e., we can read all your code in the rendered PDF\n-   each team member contributing to the repo with commits at least once\n-   the issue being closed with a commit message\n:::\n",
    "supporting": [
      "lab-5_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}